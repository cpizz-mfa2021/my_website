---
title: "COVID"
output: html_document
---



<pre class="r"><code>library(tidyverse)  # Load ggplot2, dplyr, and all the other tidyverse packages</code></pre>
<pre><code>## -- Attaching packages -------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v ggplot2 3.3.2     v purrr   0.3.4
## v tibble  3.0.3     v dplyr   1.0.2
## v tidyr   1.1.2     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0</code></pre>
<pre><code>## -- Conflicts ----------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(mosaic)</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: ggformula</code></pre>
<pre><code>## Loading required package: ggstance</code></pre>
<pre><code>## 
## Attaching package: &#39;ggstance&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:ggplot2&#39;:
## 
##     geom_errorbarh, GeomErrorbarh</code></pre>
<pre><code>## 
## New to ggformula?  Try the tutorials: 
##  learnr::run_tutorial(&quot;introduction&quot;, package = &quot;ggformula&quot;)
##  learnr::run_tutorial(&quot;refining&quot;, package = &quot;ggformula&quot;)</code></pre>
<pre><code>## Loading required package: mosaicData</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## 
## Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:tidyr&#39;:
## 
##     expand, pack, unpack</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;mosaic&#39;:
##   method                           from   
##   fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
<pre><code>## 
## The &#39;mosaic&#39; package masks several functions from core packages in order to add 
## additional features.  The original behavior of these functions should not be affected by this.
## 
## Note: If you use the Matrix package, be sure to load it BEFORE loading mosaic.
## 
## Have you tried the ggformula package for your plots?</code></pre>
<pre><code>## 
## Attaching package: &#39;mosaic&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:Matrix&#39;:
## 
##     mean</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     count, do, tally</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     cross</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     stat</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
##     quantile, sd, t.test, var</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     max, mean, min, prod, range, sample, sum</code></pre>
<pre class="r"><code>library(ggthemes)</code></pre>
<pre><code>## 
## Attaching package: &#39;ggthemes&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:mosaic&#39;:
## 
##     theme_map</code></pre>
<pre class="r"><code>library(GGally)</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<pre class="r"><code>library(readxl)
library(here)</code></pre>
<pre><code>## here() starts at C:/Users/CPizzuti/Desktop/my_website</code></pre>
<pre class="r"><code>library(skimr)</code></pre>
<pre><code>## 
## Attaching package: &#39;skimr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:mosaic&#39;:
## 
##     n_missing</code></pre>
<pre class="r"><code>library(janitor)</code></pre>
<pre><code>## 
## Attaching package: &#39;janitor&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     chisq.test, fisher.test</code></pre>
<pre class="r"><code>library(broom)
library(tidyquant)</code></pre>
<pre><code>## Loading required package: lubridate</code></pre>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<pre><code>## Loading required package: PerformanceAnalytics</code></pre>
<pre><code>## Loading required package: xts</code></pre>
<pre><code>## Loading required package: zoo</code></pre>
<pre><code>## 
## Attaching package: &#39;zoo&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     as.Date, as.Date.numeric</code></pre>
<pre><code>## 
## Attaching package: &#39;xts&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     first, last</code></pre>
<pre><code>## 
## Attaching package: &#39;PerformanceAnalytics&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     legend</code></pre>
<pre><code>## Loading required package: quantmod</code></pre>
<pre><code>## Loading required package: TTR</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre><code>## Version 0.4-0 included new data defaults. See ?getSymbols.</code></pre>
<pre><code>## == Need to Learn tidyquant? =============================================
## Business Science offers a 1-hour course - Learning Lab #9: Performance Analysis &amp; Portfolio Optimization with tidyquant!
## &lt;/&gt; Learn more at: https://university.business-science.io/p/learning-labs-pro &lt;/&gt;</code></pre>
<pre class="r"><code>library(infer)</code></pre>
<pre><code>## 
## Attaching package: &#39;infer&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:mosaic&#39;:
## 
##     prop_test, t_test</code></pre>
<pre class="r"><code>library(openintro)</code></pre>
<pre><code>## Loading required package: airports</code></pre>
<pre><code>## Loading required package: cherryblossom</code></pre>
<pre><code>## Loading required package: usdata</code></pre>
<pre><code>## 
## Attaching package: &#39;openintro&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:mosaic&#39;:
## 
##     dotPlot</code></pre>
<pre><code>## The following objects are masked from &#39;package:lattice&#39;:
## 
##     ethanol, lsegments</code></pre>
<pre class="r"><code>library(tidyquant)

UN_GDP_data  &lt;-  read_excel(here::here(&quot;data&quot;, &quot;Download-GDPconstant-USD-countries.xls&quot;), # Excel filename
                sheet=&quot;Download-GDPconstant-USD-countr&quot;, # Sheet name
                skip=2) # Number of rows to skip

tidy_GDP_data  &lt;- UN_GDP_data %&gt;%
  pivot_longer(cols = 4:51, names_to = &quot;year&quot;, values_to = &quot;Expenditure&quot;) %&gt;%mutate(Expenditure = Expenditure/(10^9))
  

clean_GDP_Data &lt;- tidy_GDP_data%&gt;%
  mutate(IndicatorName = case_when(
      IndicatorName == &quot;Final consumption expenditure&quot; ~ &quot;Total Consumption&quot;, 
      IndicatorName == &quot;Household consumption expenditure (including Non-profit institutions serving households)&quot; ~ &quot;Household Consumption&quot;, 
      IndicatorName == &quot;General government final consumption expenditure&quot; ~ &quot;Gov Consumption&quot;, 
      IndicatorName == &quot;Gross capital formation&quot; ~ &quot;Gross Capital Formation&quot;,   
      IndicatorName == &quot;Gross fixed capital formation (including Acquisitions less disposals of valuables)&quot; ~ &quot;Gross Capital&quot;, 
      IndicatorName == &quot;Exports of goods and services&quot; ~ &quot;Exports&quot;, 
      IndicatorName == &quot;Imports of goods and services&quot; ~ &quot;Imports&quot;, 
      IndicatorName == &quot;Gross Domestic Product (GDP)&quot; ~ &quot;GDP&quot;, 
      IndicatorName == &quot;Agriculture, hunting, forestry, fishing (ISIC A-B)&quot; ~ &quot;Ag/Hunt/Forest/Fish&quot;, 
      IndicatorName == &quot;Mining, Manufacturing, Utilities (ISIC C-E)&quot; ~ &quot;Min/Manu/Utility&quot;,
      IndicatorName == &quot;Manufacturing (ISIC D)&quot; ~ &quot;Manufacturing&quot;,
      IndicatorName == &quot;Construction (ISIC F)&quot; ~ &quot;Construction&quot;,
      IndicatorName == &quot;Wholesale, retail trade, restaurants and hotels (ISIC G-H)&quot; ~ &quot;Wholesale/Retail/Hospitality&quot;,
      IndicatorName == &quot;Transport, storage and communication (ISIC I)&quot; ~ &quot;Transport/Comm/Storage&quot;,
      IndicatorName == &quot;Other Activities (ISIC J-P)&quot; ~ &quot;Other&quot;,
      IndicatorName == &quot;Total Value Added&quot; ~ &quot;Total Value Added&quot;,
      IndicatorName == &quot;Changes in inventories&quot; ~ &quot;Changes in inventories&quot;))

clean_GDP_Data</code></pre>
<pre><code>## # A tibble: 176,880 x 5
##    CountryID Country     IndicatorName     year  Expenditure
##        &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;             &lt;chr&gt;       &lt;dbl&gt;
##  1         4 Afghanistan Total Consumption 1970         5.56
##  2         4 Afghanistan Total Consumption 1971         5.33
##  3         4 Afghanistan Total Consumption 1972         5.20
##  4         4 Afghanistan Total Consumption 1973         5.75
##  5         4 Afghanistan Total Consumption 1974         6.15
##  6         4 Afghanistan Total Consumption 1975         6.32
##  7         4 Afghanistan Total Consumption 1976         6.37
##  8         4 Afghanistan Total Consumption 1977         6.90
##  9         4 Afghanistan Total Consumption 1978         7.09
## 10         4 Afghanistan Total Consumption 1979         6.92
## # ... with 176,870 more rows</code></pre>
<pre class="r"><code># Let us compare GDP components for these 3 countries
country_list &lt;- c(&quot;United States&quot;,&quot;India&quot;, &quot;Germany&quot;)

US_India_Germany_GDP &lt;- clean_GDP_Data%&gt;%
  group_by(year)%&gt;%
  select(Country, IndicatorName, year, Expenditure)%&gt;%
  filter(Country %in% c(&quot;United States&quot;,&quot;India&quot;,&quot;Germany&quot;))%&gt;%
  filter(IndicatorName %in% c(&quot;Gross Capital Formation&quot;, &quot;Exports&quot;,&quot;Gov Consumption&quot;, &quot;Household Consumption&quot;, &quot;Imports&quot; ))


ggplot(US_India_Germany_GDP, aes(year, Expenditure, colour = IndicatorName, group = IndicatorName)) + geom_line() + labs (title = &quot;GDP components over time&quot;, subtitle = &quot;In constant 2010 USD&quot;, y = &quot;Billions US$&quot;, x = &quot;&quot;) + theme_bw(base_size = 10) + scale_x_discrete(breaks = c(1970, 1980, 1990, 2000, 2010)) + facet_wrap(~Country) + guides(color=guide_legend(&quot;Components of GDP&quot;)) + theme(axis.text.x = element_text(size = 6))</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
